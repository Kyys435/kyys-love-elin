<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kyys ü§ç Elin</title>
  <style>
    body {
      margin: 0;
      font-family: 'Poppins', sans-serif;
      background-color: #0b0611;
      color: white;
      overflow: hidden;
    }
    /* üå∏ Splash Screen */
    #splash {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      background: radial-gradient(circle at center, #240046, #0b0611);
      z-index: 10;
      animation: fadeOut 3s ease 4s forwards;
    }
    #splash h1 {
      font-size: 3em;
      color: #fff;
      text-shadow: 0 0 25px #b26cff, 0 0 60px #b26cff;
      animation: glow 2s ease-in-out infinite alternate;
    }
    @keyframes glow {
      from { text-shadow: 0 0 10px #b26cff, 0 0 20px #9d4edd; }
      to { text-shadow: 0 0 25px #c77dff, 0 0 60px #e0aaff; }
    }
    @keyframes fadeOut {
      to { opacity: 0; visibility: hidden; }
    }

    /* üåå Main Section */
    #main {
      display: none;
      text-align: center;
      padding: 30px;
      animation: fadeIn 2s ease forwards;
    }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    .title {
      font-size: 2em;
      margin-bottom: 10px;
      color: #d0b3ff;
      text-shadow: 0 0 10px #c77dff;
    }
    .input-box {
      margin-top: 20px;
      padding: 15px;
      border: 2px solid #a05cff;
      border-radius: 15px;
      background: rgba(255,255,255,0.05);
      display: inline-block;
    }
    input, button {
      border: none;
      outline: none;
      padding: 10px 15px;
      margin: 5px;
      border-radius: 8px;
      font-size: 1em;
    }
    input {
      background: #1c1028;
      color: #fff;
      width: 250px;
    }
    button {
      background: linear-gradient(45deg, #9d4edd, #7b2cbf);
      color: white;
      cursor: pointer;
      transition: 0.3s;
    }
    button:hover { transform: scale(1.05); box-shadow: 0 0 15px #c77dff; }
    canvas {
      border-radius: 15px;
      margin-top: 20px;
      max-width: 100%;
    }
    #loading {
      display: none;
      font-size: 1.2em;
      color: #d0b3ff;
      text-shadow: 0 0 10px #b26cff;
    }
  </style>
</head>
<body>
  <!-- üå∏ Splash -->
  <div id="splash">
    <h1>Kyys ü§ç Elin</h1>
  </div>

  <!-- üîÆ Main -->
  <div id="main">
    <div class="title">HD Enhancer</div>
    <div class="input-box">
      <input type="file" id="fileInput" accept="image/*,video/*">
      <button id="enhanceBtn">HD-kan</button>
    </div>
    <p id="loading">‚ú® Sedang memproses...</p>
    <canvas id="preview"></canvas>
  </div>

  <!-- üéµ Background Audio -->
  <audio id="bgMusic" src="intro.mp3" autoplay loop></audio>

  <script>
    // ‚è≥ Splash transition
    setTimeout(() => {
      document.getElementById('splash').style.display = 'none';
      document.getElementById('main').style.display = 'block';
    }, 6000);

    // üéµ Try to auto-play safely
    const music = document.getElementById("bgMusic");
    music.volume = 0.6;
    document.addEventListener("click", () => {
      if (music.paused) music.play();
    });

    // üñºÔ∏è HD logic (basic upscale simulation)
    const input = document.getElementById("fileInput");
    const canvas = document.getElementById("preview");
    const ctx = canvas.getContext("2d");
    const loading = document.getElementById("loading");

    document.getElementById("enhanceBtn").addEventListener("click", async () => {
      const file = input.files[0];
      if (!file) return alert("Pilih file dulu üíú");

      loading.style.display = "block";
      const url = URL.createObjectURL(file);
      const img = new Image();
      img.onload = () => {
        const scale = 4; // Simulasi 4K upscale
        canvas.width = img.width * scale;
        canvas.height = img.height * scale;
        ctx.imageSmoothingEnabled = true;
        ctx.imageSmoothingQuality = "high";
        ctx.drawImage(img, 0, 0, canvas.width, canvas.height);
        loading.style.display = "none";
        URL.revokeObjectURL(url);
      };
      img.onerror = () => {
        loading.style.display = "none";
        alert("Gagal memuat gambar/video üò¢");
      };
      img.src = url;
    });
  </script>
</body>
</html> await processImage(currentBlobUrl);
    }
    downloadBtn.classList.remove('hidden');
  } catch(err){
    alert('Gagal proses: '+ (err.message || err));
    console.error(err);
  } finally{
    loading.classList.remove('show');
  }
});

function create4KCanvas(){
  const c = document.createElement('canvas');
  c.width = 3840; c.height = 2160;
  return c;
}

function adjustPreview(off){
  const ratio = off.width / off.height;
  const tw = previewAfter.width = (ratio>1?720:360);
  const th = previewAfter.height = (ratio>1?360:720);
  afterCtx.fillStyle = '#020214'; afterCtx.fillRect(0,0,tw,th);
  const scale = Math.min(tw/off.width, th/off.height);
  const w = off.width*scale, h = off.height*scale;
  const x = (tw-w)/2, y=(th-h)/2;
  afterCtx.drawImage(off, 0,0,off.width,off.height, x,y,w,h);
  // subtle stroke
  afterCtx.strokeStyle = 'rgba(160,140,255,0.08)'; afterCtx.lineWidth = 6;
  afterCtx.strokeRect(x-4,y-4,w+8,h+8);
}

async function processImage(src){
  return new Promise((resolve,reject)=>{
    const img = new Image();
    img.crossOrigin='anonymous';
    img.onload = ()=>{
      try{
        const off = create4KCanvas();
        const octx = off.getContext('2d');
        octx.fillStyle='#000'; octx.fillRect(0,0,off.width,off.height);
        const scale = Math.min(off.width/img.naturalWidth, off.height/img.naturalHeight);
        const w = Math.round(img.naturalWidth*scale), h = Math.round(img.naturalHeight*scale);
        const x = Math.round((off.width-w)/2), y = Math.round((off.height-h)/2);
        octx.imageSmoothingEnabled = true; octx.imageSmoothingQuality='high';
        octx.drawImage(img, 0,0,img.naturalWidth,img.naturalHeight, x,y,w,h);
        adjustPreview(off);
        off.toBlob(b=>{ resultBlob = b; resolve(); }, 'image/png');
      }catch(e){ reject(e); }
    };
    img.onerror = ()=> reject(new Error('Gagal memuat gambar (CORS?)'));
    img.src = src;
  });
}

async function processVideo(src){
  return new Promise((resolve,reject)=>{
    const video = document.createElement('video');
    video.crossOrigin='anonymous';
    video.src = src;
    video.muted = true; video.playsInline = true; video.preload='auto';
    video.addEventListener('loadeddata', ()=>{
      try{
        // seek a little to ensure frame (some browsers need)
        video.currentTime = Math.min(0.5, video.duration || 0);
      }catch(e){}
    });
    video.addEventListener('seeked', ()=>{
      try{
        const off = create4KCanvas();
        const octx = off.getContext('2d');
        octx.fillStyle='#000'; octx.fillRect(0,0,off.width,off.height);
        const sw = video.videoWidth, sh = video.videoHeight;
        const scale = Math.min(off.width/sw, off.height/sh);
        const w = Math.round(sw*scale), h = Math.round(sh*scale);
        const x = Math.round((off.width-w)/2), y = Math.round((off.height-h)/2);
        octx.imageSmoothingEnabled = true; octx.imageSmoothingQuality='high';
        octx.drawImage(video, 0,0,sw,sh, x,y,w,h);
        adjustPreview(off);
        off.toBlob(b=>{ resultBlob = b; resolve(); }, 'image/png');
      }catch(e){ reject(e); }
    });
    video.onerror = ()=> reject(new Error('Gagal memuat video (CORS/format).'));
    video.load();
  });
}

downloadBtn.addEventListener('click', ()=>{
  if(!resultBlob){ alert('Belum ada hasil.'); return; }
  const url = URL.createObjectURL(resultBlob);
  const a = document.createElement('a');
  a.href = url; a.download = 'kyys_love_elin_result.png';
  document.body.appendChild(a); a.click(); a.remove();
  setTimeout(()=>{ try{ URL.revokeObjectURL(url); }catch(e){} }, 2000);
});
</script>
</body>
</html><script>
window.addEventListener('load', () => {
  const intro = document.getElementById('intro');
  const main = document.getElementById('mainContent');
  const music = document.getElementById('bgMusic');
  setTimeout(() => {
    intro.classList.add('hide');
    setTimeout(() => {
      intro.remove();
      main.classList.remove('hidden');
    }, 800);
  }, 3000);
  document.addEventListener('click', function oncePlay(){
    music.play().catch(()=>{});
    document.removeEventListener('click', oncePlay);
  });
});

const fileInput=document.getElementById('fileInput');
const fileName=document.getElementById('fileName');
const urlInput=document.getElementById('urlInput');
const enhanceBtn=document.getElementById('enhanceBtn');
const downloadBtn=document.getElementById('downloadBtn');
const previewBefore=document.getElementById('previewBefore');
const previewAfter=document.getElementById('previewAfter');
const loading=document.getElementById('loading');
const beforeCtx=previewBefore.getContext('2d');
const afterCtx=previewAfter.getContext('2d');
let currentFile=null,currentBlobUrl=null,resultBlob=null;

fileInput.addEventListener('change',e=>{
  const f=e.target.files[0];
  if(!f)return;
  currentFile=f;
  fileName.textContent=f.name;
  if(currentBlobUrl)URL.revokeObjectURL(currentBlobUrl);
  currentBlobUrl=URL.createObjectURL(f);
  renderBefore(currentBlobUrl);
});

urlInput.addEventListener('keydown',e=>{
  if(e.key==='Enter')loadFromUrl(urlInput.value.trim());
});

async function loadFromUrl(url){
  if(!url)return;
  try{
    loading.classList.add('show');
    const resp=await fetch(url);
    const blob=await resp.blob();
    const f=new File([blob],'remote',{type:blob.type});
    currentFile=f;
    fileName.textContent=f.name;
    if(currentBlobUrl)URL.revokeObjectURL(currentBlobUrl);
    currentBlobUrl=URL.createObjectURL(f);
    renderBefore(currentBlobUrl);
  }catch(err){alert('Gagal load URL');}
  finally{loading.classList.remove('show');}
}

function renderBefore(src){
  const img=new Image();
  img.onload=()=>{
    const ratio=img.naturalWidth/img.naturalHeight;
    previewBefore.width=ratio>1?720:360;
    previewBefore.height=ratio>1?360:720;
    beforeCtx.fillStyle='#0a0a12';
    beforeCtx.fillRect(0,0,previewBefore.width,previewBefore.height);
    const scale=Math.min(previewBefore.width/img.naturalWidth,previewBefore.height/img.naturalHeight);
    const w=img.naturalWidth*scale,h=img.naturalHeight*scale;
    const x=(previewBefore.width-w)/2,y=(previewBefore.height-h)/2;
    beforeCtx.drawImage(img,x,y,w,h);
  };
  img.src=src;
}

enhanceBtn.addEventListener('click',async()=>{
  if(!currentFile){alert('Pilih file dulu');return;}
  loading.classList.add('show');
  downloadBtn.classList.add('hidden');
  resultBlob=null;
  try{
    if(currentFile.type.startsWith('image/'))await processImage(currentBlobUrl);
    else await processVideo(currentBlobUrl);
    downloadBtn.classList.remove('hidden');
  }catch(err){alert('Gagal: '+err.message);}
  finally{loading.classList.remove('show');}
});

function create4KCanvas(){const c=document.createElement('canvas');c.width=3840;c.height=2160;return c;}

function adjustPreview(off){
  const ratio=off.width/off.height;
  previewAfter.width=ratio>1?720:360;
  previewAfter.height=ratio>1?360:720;
  afterCtx.clearRect(0,0,previewAfter.width,previewAfter.height);
  const scale=Math.min(previewAfter.width/off.width,previewAfter.height/off.height);
  const w=off.width*scale,h=off.height*scale;
  const x=(previewAfter.width-w)/2,y=(previewAfter.height-h)/2;
  afterCtx.drawImage(off,x,y,w,h);
}

async function processImage(src){
  return new Promise((res,rej)=>{
    const img=new Image();
    img.onload=()=>{
      const off=create4KCanvas();
      const ctx=off.getContext('2d');
      ctx.fillStyle='#000';ctx.fillRect(0,0,off.width,off.height);
      const scale=Math.min(off.width/img.naturalWidth,off.height/img.naturalHeight);
      const w=img.naturalWidth*scale,h=img.naturalHeight*scale;
      const x=(off.width-w)/2,y=(off.height-h)/2;
      ctx.imageSmoothingEnabled=true;ctx.imageSmoothingQuality='high';
      ctx.drawImage(img,x,y,w,h);
      adjustPreview(off);
      off.toBlob(b=>{resultBlob=b;res();},'image/png');
    };
    img.onerror=()=>rej(new Error('Gagal gambar'));
    img.src=src;
  });
}

async function processVideo(src){
  return new Promise((res,rej)=>{
    const v=document.createElement('video');
    v.src=src;v.muted=true;v.playsInline=true;
    v.addEventListener('loadeddata',()=>{
      const off=create4KCanvas();
      const ctx=off.getContext('2d');
      ctx.drawImage(v,0,0,off.width,off.height);
      adjustPreview(off);
      off.toBlob(b=>{resultBlob=b;res();},'image/png');
    });
    v.onerror=()=>rej(new Error('Video gagal'));
  });
}

downloadBtn.addEventListener('click',()=>{
  if(!resultBlob){alert('Belum ada hasil');return;}
  const a=document.createElement('a');
  const url=URL.createObjectURL(resultBlob);
  a.href=url;a.download='kyys_love_elin_result.png';a.click();
  setTimeout(()=>URL.revokeObjectURL(url),2000);
});
</script>
</body>
</html>fileInput.addEventListener('change',e=>{  
  const f=e.target.files[0];  
  if(!f)return;  
  currentFile=f;  
  fileName.textContent=f.name;  
  if(currentBlobUrl)URL.revokeObjectURL(currentBlobUrl);  
  currentBlobUrl=URL.createObjectURL(f);  
  renderBefore(currentBlobUrl);  
});  

urlInput.addEventListener('keydown',e=>{  
  if(e.key==='Enter')loadFromUrl(urlInput.value.trim());  
});  

async function loadFromUrl(url){  
  if(!url)return;  
  try{  
    loading.classList.add('show');  
    const resp=await fetch(url);  
    const blob=await resp.blob();  
    const f=new File([blob],'remote',{type:blob.type});  
    currentFile=f;  
    fileName.textContent=f.name;  
    if(currentBlobUrl)URL.revokeObjectURL(currentBlobUrl);  
    currentBlobUrl=URL.createObjectURL(f);  
    renderBefore(currentBlobUrl);  
  }catch(err){alert('Gagal load URL');}  
  finally{loading.classList.remove('show');}  
}  

function renderBefore(src){  
  const img=new Image();  
  img.onload=()=>{  
    const ratio=img.naturalWidth/img.naturalHeight;  
    previewBefore.width=ratio>1?720:360;  
    previewBefore.height=ratio>1?360:720;  
    beforeCtx.fillStyle='#0a0a12';  
    beforeCtx.fillRect(0,0,previewBefore.width,previewBefore.height);  
    const scale=Math.min(previewBefore.width/img.naturalWidth,previewBefore.height/img.naturalHeight);  
    const w=img.naturalWidth*scale,h=img.naturalHeight*scale;  
    const x=(previewBefore.width-w)/2,y=(previewBefore.height-h)/2;  
    beforeCtx.drawImage(img,x,y,w,h);  
  };  
  img.onerror = ()=>{};  
  img.src=src;  
}  

enhanceBtn.addEventListener('click',async()=>{  
  if(!currentFile){alert('Pilih file dulu');return;}  
  loading.classList.add('show');  
  downloadBtn.classList.add('hidden');  
  resultBlob=null;  
  try{  
    if(currentFile.type.startsWith('image/'))await processImage(currentBlobUrl);  
    else await processVideo(currentBlobUrl);  
    downloadBtn.classList.remove('hidden');  
  }catch(err){alert('Gagal: '+err.message);}  
  finally{loading.classList.remove('show');}  
});  

function create4KCanvas(){const c=document.createElement('canvas');c.width=3840;c.height=2160;return c;}  

function adjustPreview(off){  
  const ratio=off.width/off.height;  
  previewAfter.width=ratio>1?720:360;  
  previewAfter.height=ratio>1?360:720;  
  afterCtx.clearRect(0,0,previewAfter.width,previewAfter.height);  
  const scale=Math.min(previewAfter.width/off.width,previewAfter.height/off.height);  
  const w=off.width*scale,h=off.height*scale;  
  const x=(previewAfter.width-w)/2,y=(previewAfter.height-h)/2;  
  afterCtx.drawImage(off,x,y,w,h);  
}  

async function processImage(src){  
  return new Promise((res,rej)=>{  
    const img=new Image();  
    img.onload=()=>{  
      const off=create4KCanvas();  
      const ctx=off.getContext('2d');  
      ctx.fillStyle='#000';ctx.fillRect(0,0,off.width,off.height);  
      const scale=Math.min(off.width/img.naturalWidth,off.height/img.naturalHeight);  
      const w=img.naturalWidth*scale,h=img.naturalHeight*scale;  
      const x=(off.width-w)/2,y=(off.height-h)/2;  
      ctx.imageSmoothingEnabled=true;ctx.imageSmoothingQuality='high';  
      ctx.drawImage(img,x,y,w,h);  
      adjustPreview(off);  
      off.toBlob(b=>{resultBlob=b;res();},'image/png');  
    };  
    img.onerror=()=>rej(new Error('Gagal gambar'));  
    img.src=src;  
  });  
}  

async function processVideo(src){  
  return new Promise((res,rej)=>{  
    const v=document.createElement('video');  
    v.src=src;v.muted=true;v.playsInline=true;  
    v.addEventListener('loadeddata',()=>{  
      const off=create4KCanvas();  
      const ctx=off.getContext('2d');  
      ctx.drawImage(v,0,0,off.width,off.height);  
      adjustPreview(off);  
      off.toBlob(b=>{resultBlob=b;res();},'image/png');  
    });  
    v.onerror=()=>rej(new Error('Video gagal'));  
  });  
}  

downloadBtn.addEventListener('click',()=>{  
  if(!resultBlob){alert('Belum ada hasil');return;}  
  const a=document.createElement('a');  
  const url=URL.createObjectURL(resultBlob);  
  a.href=url;a.download='kyys_love_elin_result.png';a.click();  
  setTimeout(()=>URL.revokeObjectURL(url),2000);  
});  
</script>  
</body>  
</html>
