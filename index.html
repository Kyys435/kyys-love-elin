<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kyys ü§ç Elin UHD Enhancer</title>
<style>
  *{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;font-weight:bold}
  body{
    background:radial-gradient(circle at center,#1b062a,#0c0014);
    color:#fff;overflow:hidden;text-align:center;
  }
  #splash{
    position:fixed;top:0;left:0;width:100%;height:100%;
    background:radial-gradient(circle,#2d0b45,#100018);
    display:flex;align-items:center;justify-content:center;
    flex-direction:column;z-index:10;
    animation:fadeOut 1.6s ease-in-out 2.5s forwards;
  }
  #splash h1{
    font-size:2.5em;color:#d0b3ff;
    text-shadow:0 0 25px #b26cff,0 0 50px #a970ff;
    animation:glow 2s infinite alternate;
  }
  @keyframes glow{
    from{text-shadow:0 0 10px #b26cff,0 0 20px #a970ff;}
    to{text-shadow:0 0 30px #b26cff,0 0 60px #a970ff;}
  }
  @keyframes fadeOut{
    to{opacity:0;visibility:hidden;}
  }

  main{
    opacity:0;animation:showMain 1s ease 3.2s forwards;
  }
  @keyframes showMain{to{opacity:1;}}

  h2{color:#e0b6ff;margin:20px 0;text-shadow:0 0 10px #c77dff;}

  input,button{
    border:none;outline:none;padding:10px 15px;margin:5px;
    border-radius:8px;font-size:1em;font-weight:bold;
  }
  input{background:#1c1028;color:#fff;width:240px;}
  button{
    background:linear-gradient(45deg,#9d4edd,#7b2cbf);
    color:white;cursor:pointer;transition:0.3s;
  }
  button:hover{transform:scale(1.05);box-shadow:0 0 15px #c77dff;}
  canvas{border-radius:15px;margin:15px;max-width:100%;background:#0a0a12;}
  #loading{display:none;font-size:1.2em;color:#d0b3ff;text-shadow:0 0 10px #b26cff;}

  .hidden{display:none;}
  .container{margin-top:20px;}
</style>
</head>
<body>

<!-- Splash -->
<div id="splash">
  <h1>Kyys ü§ç Elin</h1>
</div>

<!-- Main -->
<main>
  <h2>UHD Enhancer</h2>
  <div class="container">
    <input type="file" id="fileInput" accept="image/*,video/*">
    <button id="enhanceBtn">‚ú® UHD-kan</button>
    <button id="downloadBtn" class="hidden">‚¨áÔ∏è Download Hasil</button>
    <p id="fileName">Tidak ada file yang dipilih</p>
  </div>

  <div>
    <h3>Before</h3>
    <canvas id="previewBefore" width="360" height="360"></canvas>
    <h3>After</h3>
    <canvas id="previewAfter" width="360" height="360"></canvas>
  </div>
  <p id="loading">‚ú® Sedang memproses...</p>
</main>

<audio id="bgAudio" src="intro.mp3" preload="auto"></audio>

<script>
  const splash=document.getElementById('splash');
  const audio=document.getElementById('bgAudio');
  const enhanceBtn=document.getElementById('enhanceBtn');
  const fileInput=document.getElementById('fileInput');
  const downloadBtn=document.getElementById('downloadBtn');
  const fileName=document.getElementById('fileName');
  const previewBefore=document.getElementById('previewBefore');
  const previewAfter=document.getElementById('previewAfter');
  const loading=document.getElementById('loading');
  const beforeCtx=previewBefore.getContext('2d');
  const afterCtx=previewAfter.getContext('2d');
  let currentFile=null,currentBlobUrl=null,resultBlob=null;

  // Play audio saat splash muncul
  window.addEventListener('load',()=>{
    audio.volume=0.7;
    audio.play().catch(()=>{});
  });

  // Setelah splash ilang ‚Üí lanjut ke main (audio tetap jalan)
  setTimeout(()=>{
    splash.style.display='none';
  },3500);

  fileInput.addEventListener('change',e=>{
    const f=e.target.files[0];
    if(!f)return;
    currentFile=f;
    fileName.textContent=f.name;
    if(currentBlobUrl)URL.revokeObjectURL(currentBlobUrl);
    currentBlobUrl=URL.createObjectURL(f);
    renderBefore(currentBlobUrl);
  });

  function renderBefore(src){
    const img=new Image();
    img.onload=()=>{
      const ratio=img.naturalWidth/img.naturalHeight;
      previewBefore.width=ratio>1?720:360;
      previewBefore.height=ratio>1?360:720;
      beforeCtx.fillStyle='#0a0a12';
      beforeCtx.fillRect(0,0,previewBefore.width,previewBefore.height);
      const scale=Math.min(previewBefore.width/img.naturalWidth,previewBefore.height/img.naturalHeight);
      const w=img.naturalWidth*scale,h=img.naturalHeight*scale;
      const x=(previewBefore.width-w)/2,y=(previewBefore.height-h)/2;
      beforeCtx.drawImage(img,x,y,w,h);
    };
    img.src=src;
  }

  enhanceBtn.addEventListener('click',async()=>{
    if(!currentFile){alert('Pilih file dulu');return;}
    loading.style.display='block';
    downloadBtn.classList.add('hidden');
    resultBlob=null;
    try{
      if(currentFile.type.startsWith('image/')) await processImage(currentBlobUrl);
      else await processVideo(currentBlobUrl);
      downloadBtn.classList.remove('hidden');
    }catch(err){
      alert('Gagal: '+err.message);
    }finally{
      loading.style.display='none';
    }
  });

  function create4KCanvas(){
    const c=document.createElement('canvas');
    c.width=3840;c.height=2160;
    return c;
  }

  async function processImage(src){
    return new Promise((res,rej)=>{
      const img=new Image();
      img.onload=()=>{
        const off=create4KCanvas();
        const ctx=off.getContext('2d');
        ctx.fillStyle='#000';
        ctx.fillRect(0,0,off.width,off.height);
        const scale=Math.min(off.width/img.naturalWidth,off.height/img.naturalHeight);
        const w=img.naturalWidth*scale,h=img.naturalHeight*scale;
        const x=(off.width-w)/2,y=(off.height-h)/2;
        ctx.imageSmoothingEnabled=true;
        ctx.imageSmoothingQuality='high';
        ctx.drawImage(img,x,y,w,h);
        adjustPreview(off);
        off.toBlob(b=>{resultBlob=b;res();},'image/png');
      };
      img.onerror=()=>rej(new Error('Gagal memuat gambar'));
      img.src=src;
    });
  }

  async function processVideo(src){
    return new Promise((res,rej)=>{
      const v=document.createElement('video');
      v.src=src;v.muted=true;v.playsInline=true;
      v.addEventListener('loadeddata',()=>{
        const off=create4KCanvas();
        const ctx=off.getContext('2d');
        ctx.drawImage(v,0,0,off.width,off.height);
        adjustPreview(off);
        off.toBlob(b=>{resultBlob=b;res();},'image/png');
      });
      v.onerror=()=>rej(new Error('Video gagal dimuat'));
    });
  }

  function adjustPreview(off){
    const ratio=off.width/off.height;
    previewAfter.width=ratio>1?720:360;
    previewAfter.height=ratio>1?360:720;
    afterCtx.clearRect(0,0,previewAfter.width,previewAfter.height);
    const scale=Math.min(previewAfter.width/off.width,previewAfter.height/off.height);
    const w=off.width*scale,h=off.height*scale;
    const x=(previewAfter.width-w)/2,y=(previewAfter.height-h)/2;
    afterCtx.drawImage(off,x,y,w,h);
  }

  downloadBtn.addEventListener('click',()=>{
    if(!resultBlob){alert('Belum ada hasil');return;}
    const a=document.createElement('a');
    const url=URL.createObjectURL(resultBlob);
    a.href=url;a.download='kyys_love_elin_result.png';a.click();
    setTimeout(()=>URL.revokeObjectURL(url),2000);
  });
</script>
</body>
</html>  <div class="preview-card">
    <canvas id="previewAfter" class="preview-canvas" width="720" height="360"></canvas>
  </div>

  <div class="footer">Made with ü§ç by <strong>KYYS</strong></div>
</div>

<div class="loading" id="loading">
  <div class="loader">
    <div class="title">‚ú® Sedang memproses...</div>
  </div>
</div>

<script>
const intro=document.getElementById('intro');
const main=document.getElementById('mainContent');
const bgMusic=document.getElementById('bgMusic');
const previewAfter=document.getElementById('previewAfter');
const afterCtx=previewAfter.getContext('2d');

function tryPlayAudio(){
  bgMusic.play().catch(()=>{
    document.addEventListener('click',()=>bgMusic.play().catch(()=>{}),{once:true});
  });
}
bgMusic.addEventListener('ended',()=>{bgMusic.currentTime=0;bgMusic.play().catch(()=>{});});

window.addEventListener('load',()=>{
  tryPlayAudio();
  setTimeout(()=>{
    intro.classList.add('hide');
    setTimeout(()=>{intro.remove();main.style.display='block';},900);
  },3000);
});

// placeholder gambar gelap (biar gak kosong)
afterCtx.fillStyle='#0a0a12';
afterCtx.fillRect(0,0,720,360);
afterCtx.fillStyle='#a783ff';
afterCtx.font='bold 26px Orbitron';
afterCtx.textAlign='center';
afterCtx.fillText('Preview Akan Muncul Di Sini',360,190);
</script>
</body>
</html>
